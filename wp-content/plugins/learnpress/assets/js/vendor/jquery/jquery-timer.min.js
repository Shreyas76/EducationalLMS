!function(o){o.backward_timer=function(e){var t={seconds:5,step:1,format:"h%:m%:s%",value_setter:void 0,on_exhausted:function(e){},on_tick:function(e){}},n=this;n.seconds_left=0,n.target=o(e),n.timeout=void 0,n.settings={},n.methods={init:function(e){n.settings=o.extend({},t,e),null==n.settings.value_setter&&(n.target.is("input")?n.settings.value_setter="val":n.settings.value_setter="text"),n.methods.reset()},start:function(){if(null==n.timeout){var e=n.seconds_left==n.settings.seconds?0:1e3*n.settings.step;setTimeout(n.methods._on_tick,e,e)}},cancel:function(){null!=n.timeout&&(clearTimeout(n.timeout),n.timeout=void 0)},reset:function(){n.seconds_left=n.settings.seconds,n.methods._render_seconds()},_on_tick:function(e){if(0!=e&&n.settings.on_tick(n),n.methods._render_seconds(),0<n.seconds_left){if(n.seconds_left<n.settings.step)var t=n.seconds_left;else t=n.settings.step;n.seconds_left-=t;var s=1e3*t;n.timeout=setTimeout(n.methods._on_tick,s,s)}else n.timeout=void 0,n.settings.on_exhausted(n)},_render_seconds:function(){var e=n.methods._seconds_to_dhms(n.seconds_left),t=n.settings.format;t=(t=-1!==t.indexOf("d%")?t.replace("d%",e.d).replace("h%",n.methods._check_leading_zero(e.h)):t.replace("h%",24*e.d+e.h)).replace("m%",n.methods._check_leading_zero(e.m)).replace("s%",n.methods._check_leading_zero(e.s)),n.target[n.settings.value_setter](t)},_seconds_to_dhms:function(e){var t=Math.floor(e/86400),s=(e=e-24*t*3600,Math.floor(e/3600)),n=(e=e-3600*s,Math.floor(e/60));return{d:t,h:s,m:n,s:Math.floor(e-60*n)}},_check_leading_zero:function(e){return e<10?"0"+e:""+e}}},o.fn.backward_timer=function(t){var s=arguments;return this.each(function(){var e=o(this).data("backward_timer");return null==e&&(e=new o.backward_timer(this),o(this).data("backward_timer",e)),e.methods[t]?e.methods[t].apply(this,Array.prototype.slice.call(s,1)):"object"!=typeof t&&t?void o.error("Method "+t+" does not exist on jQuery.backward_timer"):e.methods.init.apply(this,s)})}}(jQuery);